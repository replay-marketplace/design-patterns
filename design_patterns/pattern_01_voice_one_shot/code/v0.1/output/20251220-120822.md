# Input Prompt

I want to use Python's AST, Abstract Syntax Tree, library and I want to understand for a single file that imports all kinds of packages and modules I want to list out what it imported and what are the types. How do I do that?


---

# Anthropic Response

# Analyzing Python Imports with AST

Here's a comprehensive guide to extracting import information from a Python file using the `ast` module:

```python
import ast

class ImportAnalyzer(ast.NodeVisitor):
    def __init__(self):
        self.imports = []
    
    def visit_Import(self, node):
        """Handle 'import x' or 'import x as y' statements"""
        for alias in node.names:
            self.imports.append({
                'type': 'import',
                'module': alias.name,
                'alias': alias.asname,
                'line': node.lineno
            })
        self.generic_visit(node)
    
    def visit_ImportFrom(self, node):
        """Handle 'from x import y' statements"""
        module = node.module if node.module else ''
        level = node.level  # number of dots for relative imports
        
        for alias in node.names:
            self.imports.append({
                'type': 'from_import',
                'module': module,
                'name': alias.name,
                'alias': alias.asname,
                'level': level,
                'line': node.lineno
            })
        self.generic_visit(node)

def analyze_imports(filename):
    """Analyze all imports in a Python file"""
    with open(filename, 'r', encoding='utf-8') as f:
        tree = ast.parse(f.read(), filename=filename)
    
    analyzer = ImportAnalyzer()
    analyzer.visit(tree)
    
    return analyzer.imports

# Example usage
if __name__ == "__main__":
    imports = analyze_imports('your_file.py')
    
    for imp in imports:
        print(f"Line {imp['line']}: {imp}")
```

## Example with Different Import Types

Let's say you have a file `example.py`:

```python
import os
import sys as system
from pathlib import Path
from collections import defaultdict, Counter
from .local_module import MyClass
from ..parent_module import something as st
from typing import *
```

Here's how to analyze it with detailed output:

```python
def print_import_analysis(filename):
    imports = analyze_imports(filename)
    
    print("=" * 60)
    print(f"Import Analysis for: {filename}")
    print("=" * 60)
    
    for imp in imports:
        if imp['type'] == 'import':
            if imp['alias']:
                print(f"ðŸ“¦ import {imp['module']} as {imp['alias']}")
            else:
                print(f"ðŸ“¦ import {imp['module']}")
        
        elif imp['type'] == 'from_import':
            # Handle relative imports
            dots = '.' * imp['level']
            module_name = f"{dots}{imp['module']}" if imp['module'] else dots
            
            if imp['name'] == '*':
                print(f"â­ from {module_name} import *")
            elif imp['alias']:
                print(f"ðŸ“¥ from {module_name} import {imp['name']} as {imp['alias']}")
            else:
                print(f"ðŸ“¥ from {module_name} import {imp['name']}")
        
        print(f"   â””â”€ Line: {imp['line']}")
        print()

# Usage
print_import_analysis('example.py')
```

## Advanced: Categorizing Imports

```python
def categorize_imports(filename):
    imports = analyze_imports(filename)
    
    categorized = {
        'standard_library': [],
        'third_party': [],
        'relative': [],
        'absolute_local': []
    }
    
    import sys
    stdlib_modules = sys.stdlib_module_names  # Python 3.10+
    
    for imp in imports:
        if imp['type'] == 'import':
            module_name = imp['module'].split('.')[0]
        else:
            if imp['level'] > 0:
                categorized['relative'].append(imp)
                continue
            module_name = imp['module'].split('.')[0] if imp['module'] else

# Input Prompt

I want to have a program that searches all Python files and extracts for all modules, Python modules, Python libraries that were imported. Tell me about the types of things that this code would need to search for. For example, like which keywords, obviously the word import, but are there some other ways to import stuff? Make a list of stuff that it should search for in terms of strings. Thanks.


---

# Anthropic Response

# Python Import Patterns to Search For

Here's a comprehensive list of import patterns your code should handle:

## 1. **Basic Import Statements**
- `import module`
- `import module1, module2, module3`
- `import package.subpackage.module`

## 2. **Import With Alias**
- `import module as alias`
- `import package.module as alias`

## 3. **From-Import Statements**
- `from module import something`
- `from module import item1, item2, item3`
- `from package.subpackage import module`

## 4. **From-Import With Alias**
- `from module import something as alias`
- `from module import item1 as alias1, item2 as alias2`

## 5. **Wildcard Imports**
- `from module import *`

## 6. **Relative Imports**
- `from . import module` (current package)
- `from .. import module` (parent package)
- `from ...package import module` (grandparent package)
- `from .subpackage import module`

## 7. **Multi-line Imports**
```python
from module import (
    item1,
    item2,
    item3
)
```

Or with backslash:
```python
from module import item1, \
    item2, \
    item3
```

## 8. **Dynamic Imports (harder to detect)**
- `__import__('module')`
- `importlib.import_module('module')`
- `exec('import module')`
- `eval('__import__("module")')`

## 9. **Conditional Imports**
```python
if condition:
    import module
```

## 10. **Try-Except Imports**
```python
try:
    import module1
except ImportError:
    import module2
```

## Key Considerations:

### **Whitespace Variations**
- Spaces/tabs around keywords: `import  module` or `from   module   import   item`
- No space after comma: `import module1,module2`

### **Comments to Ignore**
- `# import module` (commented out)
- `"""import module"""` (in docstrings)
- `'''import module'''` (in docstrings)
- Inline comments: `import module  # this is a comment`

### **String Literals to Ignore**
- `"import module"` (in strings)
- `'from x import y'` (in strings)
- `f"import {var}"` (f-strings)

### **Edge Cases**
- `__all__` definitions (not imports, but related)
- `sys.modules['module']` (accessing already imported modules)
- Imports inside functions/classes
- Type hints with string annotations: `def func(x: "module.Type")`

## Recommended Approach:

For a robust solution, I'd suggest using Python's **AST (Abstract Syntax Tree)** module rather than regex searching. Here's why:

```python
import ast

# AST properly handles:
# - Actual code vs strings/comments
# - Multi-line statements
# - All import variations
# - Proper Python syntax parsing
```

If you must use string searching, search for these **keywords at line start** (accounting for indentation):
- `^\s*import\s+`
- `^\s*from\s+.*\s+import\s+`

Would you like me to provide example code using either the AST approach or regex pattern matching?

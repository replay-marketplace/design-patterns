# Input Prompt

how would you in python count the number of unique functions in a single file? do you use a library for that or do you just parse the code?


---

# Anthropic Response

# Counting Unique Functions in Python

There are several approaches, depending on your needs:

## 1. **Using AST (Built-in, Recommended)**

The `ast` module is perfect for this - no external dependencies needed:

```python
import ast

def count_functions(filename):
    with open(filename, 'r') as file:
        tree = ast.parse(file.read())
    
    functions = set()
    
    for node in ast.walk(tree):
        if isinstance(node, ast.FunctionDef):
            functions.add(node.name)
    
    return len(functions)

# Usage
print(count_functions('myfile.py'))
```

**More detailed version** (distinguishes methods from functions):

```python
import ast

def count_functions(filename):
    with open(filename, 'r') as file:
        tree = ast.parse(file.read())
    
    functions = set()
    methods = set()
    
    for node in ast.walk(tree):
        if isinstance(node, ast.FunctionDef):
            # Check if it's inside a class (method) or not (function)
            parent = getattr(node, 'parent', None)
            if isinstance(parent, ast.ClassDef):
                methods.add(node.name)
            else:
                functions.add(node.name)
    
    return {
        'functions': len(functions),
        'methods': len(methods),
        'total': len(functions) + len(methods)
    }
```

## 2. **Using Regular Expressions (Quick & Dirty)**

```python
import re

def count_functions_regex(filename):
    with open(filename, 'r') as file:
        content = file.read()
    
    # Match function definitions
    pattern = r'^\s*def\s+(\w+)\s*\('
    functions = set(re.findall(pattern, content, re.MULTILINE))
    
    return len(functions)
```

⚠️ **Warning**: This won't handle edge cases well (strings containing "def", nested functions, etc.)

## 3. **Using Libraries**

For more advanced analysis:

```python
# Using 'astroid' (used by pylint)
import astroid

def count_functions_astroid(filename):
    with open(filename, 'r') as file:
        module = astroid.parse(file.read())
    
    functions = {node.name for node in module.nodes_of_class(astroid.FunctionDef)}
    return len(functions)
```

## **Recommendation**

**Use `ast`** - it's built-in, reliable, and handles Python syntax correctly. It's the standard way to analyze Python code structure.

The key advantages:
- ✅ No external dependencies
- ✅ Handles all Python syntax correctly
- ✅ Can distinguish between functions, methods, async functions, etc.
- ✅ Can access additional metadata (decorators, arguments, etc.)
